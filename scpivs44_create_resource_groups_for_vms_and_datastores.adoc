---
sidebar: sidebar 
permalink: scpivs44_create_resource_groups_for_vms_and_datastores.html 
keywords:  
summary: リソースグループは、保護するVM、データストア、vSphereタグ、およびvSphere VMフォルダのコンテナです。 
---
= リソースグループの作成
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
リソースグループは、保護するVM、データストア、vSphereタグ、およびvSphere VMフォルダのコンテナです。

リソースグループには次のものを含めることができます。

* 従来のVMとデータストア
+
従来のVM、従来のSANデータストア、従来のNASデータストアの任意の組み合わせ。従来のVMをVVol VMと組み合わせることはできません。

* FlexGroupテタストア
+
単一のFlexGroupデータストア。FlexGroupデータストアのスパニングはサポートされていません。FlexGroupデータストアを従来のVMまたはデータストアと組み合わせることはできません。

* FlexVolテタストア
+
1つ以上のFlexVolデータストア。スパニングデータストアがサポートされます。

* VVOL VM
+
1つ以上のvVol VM。vVol VMを従来のVMまたはデータストアと組み合わせることはできません。

* vSphereタグ
+
指定したvSphereタグが設定されたすべてのVMとデータストア（VVolデータストアを除く）。

* フォルダ内のVVol VM
+
すべてのVVolを1つの指定したVVolフォルダに格納します。フォルダにVVOL VMと従来のVMが混在している場合、SnapCenter Plug-in for VMware vSphereはVVOL VMをバックアップし、従来のVMはスキップします。



すべてのリソースグループ：


IMPORTANT: VMware vSphere Cluster Service（vCLS）を使用している場合は、vCLSで管理されるVMをSnapCenter Plug-in for VMware vSphereリソースグループに含めないでください。


TIP: SnapCenter Plug-in for VMware vSphere 4.5以降では、最大300TBのボリュームで、最大128TBの大規模なLUNおよびファイル上のデータストアがサポートされます。大規模なLUNを保護する場合は、レイテンシを回避するためにシックプロビジョニングLUNのみを使用してください。


IMPORTANT: アクセスできない状態のVMは追加しないでください。アクセスできないVMを含むリソースグループを作成することは可能ですが、そのリソースグループのバックアップは失敗します。

.開始する前に
VVOL VMを含むリソースグループを作成する前に、ONTAP tools for VMwareを導入しておく必要があります。

詳細については、を参照してください https://docs.netapp.com/us-en/ontap-tools-vmware-vsphere/index.html["VMware vSphere向けONTAPツール"^]。

.タスクの内容
リソースグループのリソースは、いつでも追加または削除できます。

* 単一リソースのバックアップ
+
単一のリソース（単一のVMなど）をバックアップするには、その単一のリソースを含むリソースグループを作成する必要があります。

* フクスウノリソースノバックアップ
+
複数のリソースをバックアップするには、複数のリソースを含むリソースグループを作成する必要があります。

* MetroCluster環境のFlexGroupを含むリソースグループ
+
ONTAP 9.8またはONTAP 9.9を実行している場合は、スイッチオーバーまたはスイッチバックのあとに、SnapCenter Plug-in for VMware vSphereサービスを再起動してSnapMirror関係を再同期してから、MetroCluster環境でリソースグループをバックアップする必要があります。

+
ONTAP 9 .8では、スイッチバック後にバックアップがハングします。この問題はONTAP 9で修正されています。9

* Snapshotの最適化
+
Snapshotを最適化するには、同じボリュームに関連付けられているVMとデータストアを1つのリソースグループにグループ化する必要があります。

* バックアップポリシー
+
リソースグループはバックアップポリシーなしで作成できますが、データ保護処理はリソースグループに少なくとも1つのポリシーが適用されている場合にのみ実行できます。リソースグループの作成プロセスで、既存のポリシーを使用するか、新しいポリシーを作成できます。

+

NOTE: Snapshotロック期間が設定されたバックアップポリシーを選択する場合は、ONTAP 9.12.1以降のバージョンを選択する必要があります。



* 互換性チェック
+
SnapCenterは、リソースグループの作成時に互換性チェックを実行します。

+
<<互換性チェックの失敗を管理>>



.手順
. SCVプラグインの左側のナビゲーションペインで、*[リソースグループ]*をクリックし、*[作成]*を選択してウィザードを開始します。


これは、リソースグループを作成する最も簡単な方法です。ただし、次のいずれかを実行して、1つのリソースを含むリソースグループを作成することもできます。

* 1つのVMのリソースグループを作成するには、ショートカットページで*[ホストおよびクラスタ]*を選択し、VMを右クリックして* SnapCenter Plug-in for VMware vSphere *>*[リソースグループの作成]*を選択します。
* 1つのデータストアのリソースグループを作成するには、ショートカットページで*[ホストおよびクラスタ]*を選択し、データストアを右クリックして* SnapCenter Plug-in for VMware vSphere *>*[リソースグループの作成]*を選択します。
+
.. ウィザードの [ 一般情報と通知 *] ページで、次の操作を行います。
+
|===
| このフィールドでは… | 操作 


| vCenter Server | vCenterサーバを選択します。 


| 名前 | リソースグループの名前を入力します。VM 、データストア、ポリシー、バックアップ、リソースグループの名前には、次の特殊文字は使用できません： %&*$#@ ！\ / ： * ？"<> - [ 垂直バー ] ； ' 、アンダースコア（_）を使用できます。特殊文字を含むVMまたはデータストアの名前は切り捨てられるため、特定のバックアップを検索することが困難になります。リンクモードでは、各vCenterに個別のSnapCenter Plug-in for VMware vSphereリポジトリがあります。そのため、複数のvCenterで重複した名前を使用できます。 


| 製品説明 | リソースグループの説明を入力します。 


| 通知 | このリソースグループ上の処理に関する通知を受信する場合に選択します。エラーまたは警告：エラーおよび警告のみの通知を送信：エラーのみの通知を送信：すべてのメッセージタイプの通知を送信しない：通知を送信しません 


| Eメール送信元 | 通知の送信元のEメールアドレスを入力します。 


| Eメール送信先 | 通知の受信者のEメールアドレスを入力します。受信者が複数いる場合は、Eメールアドレスをカンマで区切って指定します。 


| Eメールの件名 | 通知メールの件名を入力します。 


| 最新のSnapshot名  a| 
最新のSnapshotにサフィックス「_recent」を追加する場合は、このチェックボックスをオンにします。「 _recent 」サフィックスは、日付とタイムスタンプを置き換えます。


NOTE:  `_recent`バックアップは、リソースグループに適用されているポリシーごとに作成されます。そのため、リソースグループに複数のポリシーが設定されている場合は、複数のバックアップが作成され `_recent` ます。バックアップの名前を手動で変更しない `_recent` でください。



| カスタムSnapshot形式  a| 
Snapshot名にカスタム形式を使用する場合は、このボックスをオンにして名前形式を入力します。

*** デフォルトでは、この機能は無効になっています。
*** デフォルトのSnapshot名はの形式を使用し `<ResourceGroup>_<Date-TimeStamp>` ますが、変数$ResourceGroup、$Policy、$HostName、$ScheduleType、および$CustomTextを使用してカスタムの形式を指定できます。[カスタム名]フィールドのドロップダウンリストを使用して、使用する変数とその使用順序を選択します。$CustomTextを選択した場合、名前の形式はになります `<CustomName>_<Date-TimeStamp>`。表示された追加ボックスにカスタムテキストを入力します。[注]：「_recent」サフィックスも選択する場合は、カスタムSnapshot名がデータストア内で一意であることを確認する必要があります。そのため、$resourcegroup変数と$Policy変数を名前に追加する必要があります。
*** 名前に特殊文字が含まれている場合は、 Name フィールドと同じガイドラインに従ってください。


|===
.. [* リソース *] ページで、次の操作を実行します。
+
|===
| このフィールドでは… | 操作 


| 適用範囲 | 保護するリソースのタイプを選択します。*データストア（指定した1つ以上のデータストア内の従来のすべてのVM）。VVolデータストアは選択できません。*仮想マシン（従来のVMまたはVVol VMを個別に移動。フィールドでは、VMまたはVVol VMを含むデータストアに移動する必要があります）。FlexGroupデータストア内のVMを個別に選択することはできません。*タグタグベースのデータストア保護は、NFSデータストアとVMFSデータストア、および仮想マシンとVVOL仮想マシンでのみサポートされます。* VMフォルダ（指定したフォルダ内のすべてのVVol VM。ポップアップフィールドでフォルダが配置されているデータセンターに移動する必要があります） 


| データセンター | 追加するVMまたはデータストアまたはフォルダに移動します。 リソースグループ内のVMとデータストアの名前は一意である必要があります。 


| 使用可能なエンティティ | 保護するリソースを選択し、 * > * をクリックして選択した項目を選択したエンティティリストに移動します。 
|===
+
[ 次へ ] をクリックすると、システムはまず SnapCenter が管理していることを確認し、選択したリソースがあるストレージと互換性があることを確認します。

+
メッセージが表示される場合は `Selected <resource-name> is not SnapCenter compatible` 、選択したリソースがSnapCenterと互換性がありません。

+
1つ以上のデータストアをバックアップからグローバルに除外するには、構成ファイルのプロパティにデータストア名を指定する必要があり `global.ds.exclusion.pattern` `scbr.override` ます。を参照してください link:scpivs44_properties_you_can_override.html["オーバーライド可能なプロパティ"]。

.. [ * スパニングディスク * ] ページで、複数のデータストアに複数の VMDK がある VM のオプションを選択します。
+
*** Always exclude all spanning datastores（データストアのデフォルト）
*** すべてのスパニングデータストアを常に含める（VMのデフォルト）
*** 含めるスパニングデータストアを手動で選択する
+
FlexGroupデータストアとVVolデータストアでは、複数のVMにまたがることはできません。



.. [* Policies] ページで、次の表に示すように 1 つ以上のバックアップポリシーを選択または作成します。
+
|===
| を使用するには ... | 操作 


| 既存のポリシー | リストから1つ以上のポリシーを選択します。 


| 新しいポリシー  a| 
... 「 * Create * 」を選択します。
... [New Backup Policy]ウィザードの手順に従って[Create Resource Group]ウィザードに戻ります。


|===
+
リンクモードでは、リンクされたすべてのvCenterのポリシーがリストに含まれます。リソースグループと同じvCenter上にあるポリシーを選択する必要があります。

.. [* Schedules* ] ページで、選択した各ポリシーのバックアップスケジュールを設定します。
+
image:scpivs44_image18.png["[リソースグループの作成]ウィンドウ"]

+
[Starting hour]フィールドに、ゼロ以外の日時を入力します。日付はの形式で指定する必要があり `day/month/year`ます。

+
[Every]フィールドで日数を選択すると、月の1日目にバックアップが実行され、その後、指定した間隔でバックアップが実行されます。たとえば、オプション「 * Every 2 days * 」を選択すると、開始日が偶数か奇数かに関係なく、 1 日目、 3 日目、 5 日目、 7 日目などの月全体にバックアップが実行されます。

+
各フィールドに入力する必要があります。SnapCenter Plug-in for VMware vSphereでは、SnapCenter Plug-in for VMware vSphereが導入されているタイムゾーンでスケジュールが作成されます。タイムゾーンは、SnapCenter Plug-in for VMware vSphere GUIを使用して変更できます。

+
link:scpivs44_modify_the_time_zones.html["バックアップのタイムゾーンの変更"]です。

.. 概要を確認し、 [ 完了 ] をクリックします。
+
「 * 完了」をクリックする前に、ウィザードの任意のページに戻って情報を変更できます。

+
[ 完了 ] をクリックすると ' 新しいリソースグループがリソースグループリストに追加されます

+

NOTE: バックアップ内のいずれかのVMで休止処理が失敗した場合、選択したポリシーでVM整合性が選択されていても、バックアップはVM整合性なしとマークされます。この場合、一部のVMが正常に休止されている可能性があります。







== 互換性チェックの失敗を管理

SnapCenterは、リソースグループを作成しようとすると互換性チェックを実行します。

互換性がない理由は次のとおりです。

* VMDKがサポート対象外のストレージ（7-Modeを実行しているONTAPシステムやONTAP以外のデバイスなど）に配置されている。
* データストアがclustered Data ONTAP 8.2.1以前を実行しているNetAppストレージにある。
+
SnapCenterバージョン4.xではONTAP 8.3.1以降がサポートされます。

+
SnapCenter Plug-in for VMware vSphereでは、すべてのONTAPバージョンの互換性チェックは実行されません。ONTAPバージョン8.2.1以前の場合のみです。そのため、SnapCenterのサポートに関する最新情報については、を参照してください https://imt.netapp.com/matrix/imt.jsp?components=121034;&solution=1517&isHWU&src=IMT["NetApp Interoperability Matrix Tool（IMT）"^] 。

* 共有PCIデバイスがVMに接続されている。
* 優先IPアドレスがSnapCenterに設定されていません。
* Storage VM（SVM）管理IPアドレスをSnapCenterに追加していません。
* Storage VMは停止しています。


互換性エラーを修正するには、次の手順に従います。

. Storage VMが実行されていることを確認してください。
. VMが配置されているストレージシステムがSnapCenter Plug-in for VMware vSphereインベントリに追加されていることを確認します。
. Storage VMがSnapCenterに追加されていることを確認してください。VMware vSphere Client GUIで[Add storage system]オプションを使用します。
. NetAppとNetApp以外の両方のデータストアにVMDKを含む複数のVMがある場合は、それらのVMDKをNetAppデータストアに移動します。

